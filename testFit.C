// for crosschecking with timothy
void testFit() {
  const Int_t N = 36;
  Float_t data[N][4] = 
  {{1.0572, 1.0472, 0.192654, 0.001}, {2.1044, 1.0472, -0.357535, 
  0.001}, {3.15159, 1.0472, -0.548761, 0.001}, {4.19879,
  1.0472, -0.191331, 0.001}, {5.24599, 1.0472, 0.355837,
  0.001}, {6.29319, 1.0472, 0.548299, 0.001}, {1.0572, 2.0944,
  0.735992, 0.001}, {2.1044, 2.0944, 0.189061, 0.001}, {3.15159,
  2.0944, -0.548702, 0.001}, {4.19879, 2.0944, -0.736717,
  0.001}, {5.24599, 2.0944, -0.189177, 0.001}, {6.29319, 2.0944,
  0.548166, 0.001}, {1.0572, 3.14159, 0.736127, 0.001}, {2.1044,
  3.14159, 0.735568, 0.001}, {3.15159, 3.14159, -0.00199127,
  0.001}, {4.19879, 3.14159, -0.739756, 0.001}, {5.24599,
  3.14159, -0.733146, 0.001}, {6.29319, 3.14159, 0.00247198,
  0.001}, {1.0572, 4.18879, 0.1921, 0.001}, {2.1044, 4.18879,
  0.735423, 0.001}, {3.15159, 4.18879, 0.542228, 0.001}, {4.19879,
  4.18879, -0.190633, 0.001}, {5.24599, 4.18879, -0.735611,
  0.001}, {6.29319, 4.18879, -0.544062, 0.001}, {1.0572,
  5.23599, -0.353693, 0.001}, {2.1044, 5.23599, 0.18917,
  0.001}, {3.15159, 5.23599, 0.541908, 0.001}, {4.19879, 5.23599,
  0.3533, 0.001}, {5.24599, 5.23599, -0.187397, 0.001}, {6.29319,
  5.23599, -0.545086, 0.001}, {1.0572, 6.28319, -0.356047,
  0.001}, {2.1044, 6.28319, -0.356862, 0.001}, {3.15159,
  6.28319, -0.000687311, 0.001}, {4.19879, 6.28319, 0.351536,
  0.001}, {5.24599, 6.28319, 0.355057, 0.001}, {6.29319, 6.28319,
  0.00191011, 0.001}};

  TGraph2DErrors * g = new TGraph2DErrors;
  g->SetMarkerStyle(kFullCircle);
  g->SetTitle("graph;#phi_{R};#phi_{h};asym");
  for(int i=0; i<N; i++) {
    g->SetPoint(i,data[i][0],data[i][1],data[i][2]);
    g->SetPointError(i,0,0,data[i][3]);
  };

  const Double_t pi = TMath::Pi();
  TF2 * f = new TF2("f","[0]*TMath::Sin(y-x)+[1]*TMath::Sin(x)",-pi,pi,-pi,pi);
  f->SetParNames("A_{hr}","A_{r}");
  f->SetParameters(0.6,-0.2);
  g->Fit(f,"M","");

  gStyle->SetOptFit(1);
  new TCanvas();
  g->Draw("err p");
  //g->Draw("tri");
  f->Draw("surf same");
  printf("chi2/ndf = %f / %d\n",f->GetChisquare(),f->GetNDF());
};
